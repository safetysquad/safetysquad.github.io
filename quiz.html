<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8">
  <title>Quiz ‚Äì SAFETY SQUAD</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="style.css?v=6">
<style>
  .quiz-block {
    display: flex;
    align-items: center;
    justify-content: flex-start; /* Link links, Retry rechts */
    gap: 8px; /* Abstand zwischen Buttons */
    margin-bottom: 12px;
    flex-wrap: wrap; /* kleine Screens umbrechen */
  }

  /* Quiz-Link */
  .quiz-link {
    flex: 0 1 auto;           /* darf schrumpfen, bleibt links */
    display: flex;
    align-items: center;
    gap: 5px;                 /* Abstand Text <-> Badge */
    padding: 6px 10px;
    font-size: 0.85rem;       /* kleiner als Retry */
    white-space: nowrap;
    text-decoration: none;
    color: #000;
    background-color: #e0e0e0;
    border-radius: 6px;
    min-width: 120px;         /* verhindert zu kleine Buttons */
  }

  .quiz-badge {
    font-weight: bold;
    font-size: 0.85rem;
    margin-left: 5px;
  }

  /* Retry-Button */
  .retry-btn {
    flex: 0 1 auto;           /* darf schrumpfen */
    padding: 8px 14px;        /* gr√∂√üer als Quiz-Link */
    font-size: 1rem;
    white-space: nowrap;
    background-color: #ffcccc;
    border-radius: 6px;
    text-decoration: none;
    color: #000;
    min-width: 200px;         /* verhindert zu schmal bei vielen Buchstaben */
  }

  /* Hover-Effekte */
  .quiz-link:hover {
    background-color: #d0d0d0;
  }
  .retry-btn:hover {
    background-color: #ffb3b3;
  }
</style>



</head>

<body>
<div class="app">

  <!-- ================= HEADER ================= -->
  <header class="header-bar">
    <button class="burger" onclick="toggleMenu()">‚ò∞</button>
    <div class="header-text">
      <h1>üìù Quiz</h1>
      <p>W√§hle einen Test</p>
    </div>
  </header>

  <!-- ================= BURGER MEN√ú ================= -->
  <div id="moreMenu" class="more-menu hidden">
    <a href="stats.html">üìä Statistik</a>
    <a href="index.html">‚¨Ö Startseite</a>
  </div>

  <!-- ================= GLOBALER BUTTON ================= -->
  <div id="global-wrong-container"></div>

  <!-- ================= QUIZ LISTE ================= -->
  <main id="quiz-list"></main>

</div>

<!-- ================= SCRIPTS ================= -->
<script src="quiz-data.js"></script>
<script>
function renderQuizDashboard() {
  const quizListEl = document.getElementById("quiz-list");
  const globalContainer = document.getElementById("global-wrong-container");
  quizListEl.innerHTML = "";
  globalContainer.innerHTML = "";

  let totalWrong = 0;

  Object.keys(quizzes).forEach(quizId => {
    const quiz = quizzes[quizId];
    const savedWrong = JSON.parse(localStorage.getItem(`safety_${quizId}_wrong`) || "[]");
    const best = localStorage.getItem(`safety_${quizId}_best`);

    totalWrong += savedWrong.length;

    // ================= Quiz-Block =================
    const block = document.createElement("div");
    block.className = "quiz-block";

    const link = document.createElement("a");
    link.href = `quiz-run.html?id=${quizId}`;
    link.className = "btn quiz-link";
    link.innerText = `${quizId}`; // z.B. Quiz 1

    const badge = document.createElement("span");
    badge.classList.add("quiz-badge");
    if (!best) {
      badge.innerText = "Neu";
      badge.classList.add("new");
    } else {
      badge.innerText = `${best}%`;
      if (Number(best) === 100) badge.classList.add("gold");
    }
    link.appendChild(badge);
    block.appendChild(link);

    // Retry-Button pro Quiz
    if (savedWrong.length > 0) {
      const retryBtn = document.createElement("a");
      retryBtn.href = `quiz-run.html?id=${quizId}&retryWrong=1`;
      retryBtn.className = "btn warn small retry-btn";
      retryBtn.innerText = `‚ùå Falsche Fragen wiederholen (${savedWrong.length})`;
      block.appendChild(retryBtn);
    }

    quizListEl.appendChild(block);
  });

  // Globaler Button f√ºr alle falschen Fragen
  if (totalWrong > 0) {
    const btn = document.createElement("a");
    btn.href = "quiz-run.html?globalWrong=1";
    btn.className = "btn warn large";
    btn.innerText = `‚ùå Alle falschen Fragen wiederholen (${totalWrong})`;
    globalContainer.appendChild(btn);
  }
}

// ================= Burger Men√º =================
function toggleMenu() {
  const menu = document.getElementById("moreMenu");
  if (menu) menu.classList.toggle("hidden");
}

// ======================
// Seite laden
// ======================
document.addEventListener("DOMContentLoaded", renderQuizDashboard);
</script>

</body>
</html>
